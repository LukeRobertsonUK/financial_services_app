%p#notice= notice

%p
  %b Author:
  = @post.user.full_name
%p
  %b Title:
  = @post.title
%p
  %b Content:
  = @post.content


= link_to "Comment", new_comment_path(post_id: @post.id)
|
= link_to 'Edit', edit_post_path(@post)
|
= link_to 'Back', posts_path
%br
-unless @post.user == current_user
  - if @post.has_been_flagged_by(current_user)
    You have flagged this post as inapporpriate
  - else
    = link_to "flag as inappropriate", mark_post_inappropriate_path(@post, post_id: @post.id)

%h3 Comments
-@post.comments.each do |comment|
  - if comment.visible_poster_only
    - if (comment.user == current_user) || (comment.post.user == current_user)
      =comment.content
      -if comment.has_been_flagged_by(current_user)
        You have flagged this comment as inappropriate
      -else
        =link_to "flag comment as inappropriate", mark_comment_inappropriate_path(comment, comment_id: comment.id)
  - else
    =comment.content
    -if comment.has_been_flagged_by(current_user)
      You have flagged this comment as inappropriate
    -else
      =link_to "flag comment as inappropriate", mark_comment_inappropriate_path(comment, comment_id: comment.id)